1 
SELECT * FROM (SELECT text
FROM VÝRAZ vyraz
JOIN KLÍCOVÉ_SLOVO klic ON  vyraz.id_výrazu = klic.VÝRAZ_ID_VÝRAZU
JOIN KNIHA kniha ON klic.KNIHA_ID_KNIHY = kniha.ID_KNIHY
WHERE místo_vydání LIKE 'Upper Saddle River, NJ'
GROUP BY text
ORDER BY count(ID_VÝRAZU) DESC)
WHERE rownum<= 1;

2 
SELECT * FROM (SELECT text
FROM VÝRAZ vyraz
JOIN KLÍCOVÉ_SLOVO KS on vyraz.ID_VÝRAZU = KS.VÝRAZ_ID_VÝRAZU
JOIN KNIHA K on K.ID_KNIHY = KS.KNIHA_ID_KNIHY
WHERE nakladatel LIKE 'Computer Press'
GROUP BY vyraz.text
ORDER BY count(ID_VÝRAZU) DESC)
FETCH FIRST ROWS ONLY;

3
SELECT count(DISTINCT id_výrazu) as pocet
FROM výraz vyraz
JOIN KLÍCOVÉ_SLOVO klic ON  vyraz.id_výrazu = klic.VÝRAZ_ID_VÝRAZU
JOIN KNIHA kniha ON klic.KNIHA_ID_KNIHY = kniha.ID_KNIHY
WHERE místo_vydání LIKE 'Praha';

4
SELECT count(DISTINCT ID_VÝRAZU) FROM VÝRAZ
JOIN KLÍCOVÉ_SLOVO KS on VÝRAZ.ID_VÝRAZU = KS.VÝRAZ_ID_VÝRAZU
JOIN KNIHA K on K.ID_KNIHY = KS.KNIHA_ID_KNIHY
JOIN JAZYK J on J.ID_JAZYKU = K.JAZYK_ID_JAZYKU
WHERE J.NÁZEV != 'ceština';

5 
SELECT NÁZEV, count(ID_VÝPUJCKY) pocet FROM KNIHA K
JOIN EXEMPLÁR E on K.ID_KNIHY = E.KNIHA_ID_KNIHY
JOIN VÝPUJCKA V on E.ID_EXEMPLÁRE = V.EXEMPLÁR_ID_EXEMPLÁRE
JOIN OSOBA O on O.ID_OSOBY = V.OSOBA_ID_OSOBY
WHERE O.JMÉNO LIKE 'František'
GROUP BY K.NÁZEV
ORDER BY pocet DESC, NÁZEV
OFFSET 1 ROW
FETCH FIRST ROW ONlY;

6
SELECT count(ID_VÝPUJCKY) FROM VÝPUJCKA V
JOIN OSOBA O on V.OSOBA_ID_OSOBY = O.ID_OSOBY
JOIN EXEMPLÁR E on E.ID_EXEMPLÁRE = V.EXEMPLÁR_ID_EXEMPLÁRE
JOIN KLÍCOVÉ_SLOVO KS on E.KNIHA_ID_KNIHY = KS.KNIHA_ID_KNIHY
JOIN VÝRAZ V on V.ID_VÝRAZU = KS.VÝRAZ_ID_VÝRAZU
WHERE V.TEXT LIKE 'web stránky'
GROUP BY V.ID_VÝPUJCKY
ORDER BY count(O.ID_OSOBY) DESC;

7

8 

9 
SELECT COUNT(DISTINCT id_knihy) FROM kniha WHERE autor IS NULL;

10 
SELECT MIN(ROK_VYDÁNÍ) FROM kniha;

11 
SELECT název FROM kniha
GROUP BY název
order by length(název) DESC
FETCH FIRST ROWS ONLY;

12 
SELECT round( 100 - (count(email) * 100) / (count(id_osoby)), 3) FROM OSOBA;   

13 
SELECT round((count(POZNÁMKA) * 100) / (count(ID_EXEMPLÁRE)), 3) FROM EXEMPLÁR;

14
SELECT ISBN FROM kniha
WHERE edice IS NULL AND POCET_STRAN >= 184 AND lower(nakladatel) LIKE '%r%'
ORDER BY NÁZEV
FETCH FIRST ROW ONLY;

15 


16
SELECT COUNT(ID_EXEMPLÁRE) FROM EXEMPLÁR
JOIN VÝPUJCKA V on EXEMPLÁR.ID_EXEMPLÁRE = V.EXEMPLÁR_ID_EXEMPLÁRE
WHERE SKUTECNE_VRÁCENO < VRÁTIT_DO;


17
SELECT concat(upper(JMÉNO), ', ') || lower(PRÍJMENÍ) AS fullname, pocet FROM OSOBA
    JOIN
(SELECT count(EXEMPLÁR_ID_EXEMPLÁRE) pocet, OSOBA_ID_OSOBY from VÝPUJCKA
WHERE SKUTECNE_VRÁCENO > VRÁTIT_DO
GROUP BY OSOBA_ID_OSOBY) ON OSOBA.ID_OSOBY = OSOBA_ID_OSOBY
ORDER BY pocet DESC
FETCH FIRST ROW ONlY;

18